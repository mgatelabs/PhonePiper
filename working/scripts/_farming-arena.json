//@formatter:off
{
  "vars": [
    {
      "name": "arena_runs",
      "display": "Arenas",
      "value": "0",
      "type": "INT",
      "modify": "VISIBLE",
      "order": 5,
      "tierId": "stats",
      "description": "How many ARENA runs have been accomplished"
    },
    {
      "name": "allow-arena",
      "display": "Arena",
      "value": "0",
      "type": "INT",
      "modify": "EDITABLE",
      "displayType": "BOOLEAN",
      "order": 10,
      "tierId": "enable",
      "values": [
        {"name": "Enabled", "value": "1"},
        {"name": "Disabled", "value": "0"}
      ],
      "description": "Enable / Disable ARENA"
    },
    {
      "name" : "arena-party-index",
      "display" : "Battle Index",
      "value" : "0",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 0,
      "tierId": "arena",
      "values": [
        {"name": "One (Left)", "value": "0"},
        {"name": "Two", "value": "1"},
        {"name": "Three", "value": "2"},
        {"name": "Four", "value": "3"},
        {"name": "Five (Right)", "value": "4"}
      ]
    }, {
      "name" : "arena-party-defense-index",
      "display" : "Defense Index",
      "value" : "0",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 0,
      "tierId": "arena",
      "values": [
        {"name": "One (Left)", "value": "0"},
        {"name": "Two", "value": "1"},
        {"name": "Three", "value": "2"},
        {"name": "Four", "value": "3"},
        {"name": "Five (Right)", "value": "4"}
      ]
    }, {
      "name" : "arena-rule-black_magic",
      "display" : "Allow Black Magic",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-white_magic",
      "display" : "Allow White magic",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-physical_combos",
      "display" : "Allow Physical combos",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-magic_combos",
      "display" : "Allow Magic combos",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-multi_abilities",
      "display" : "Allow Multiple use abilities",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-recovery",
      "display" : "Allow Recovery",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-status",
      "display" : "Allow Status ailments",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-boosts",
      "display" : "Allow Parameter boosts",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-reductions",
      "display" : "Allow Parameter reductions",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-death",
      "display" : "Allow Death",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 10,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-light",
      "display" : "Allow Light",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-dark",
      "display" : "Allow Dark",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-fire",
      "display" : "Allow Fire",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-water",
      "display" : "Allow Water",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-ice",
      "display" : "Allow Ice",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-earth",
      "display" : "Allow Earth",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-lightning",
      "display" : "Allow Lightning",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    }, {
      "name" : "arena-rule-wind",
      "display" : "Allow Wind",
      "value" : "1",
      "type" : "INT",
      "modify" : "EDITABLE",
      "displayType" : "STANDARD",
      "order" : 20,
      "tierId": "arena-rules",
      "values": [
        {"name": "No", "value": "0"},
        {"name": "Yes", "value": "1"}
      ]
    },
    {
      "name": "_route_from_arena",
      "display": "After Arena",
      "value": "EXPEDITION",
      "type": "STRING",
      "varValueId": "ROUTES","varValueId": "ROUTES",
      "modify": "EDITABLE",
      "order": 10,
      "tierId": "state-route",
      "description": "Where to go next after Arena is finished.  Default is EXPEDITION to check expeditions."
    }
  ],
  "varTiers": [
    {"title":"Arena", "id":"arena", "tabId":"arena"},
    {"title":"Arena Rules", "id":"arena-rules", "tabId":"arena"}
  ],
  "varValues": [
    {"group":"ROUTES", "title":"Arena", "value":"ARENA"}
  ],
  "states":{

    "arena-home": {
      "name": "Arena - Menu",
      "includes": [
        "_arena-menu-orbs",
        "_arena-menu-rules",
        "_arena-find_depart_team",
        "_arena-menu-opponent-select",
        "_arena-menu-confirm-select",
        "_arena-menu-begin",
        "_arena-battle-start",
        "_common-no_op"
      ],
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-have-orbs",
            "andOr": [
              {
                "is": "SCREEN",
                "value": "menu-arena_screen"
              },
              {
                "is": "SCREEN",
                "value": "menu-arena_screen-friends"
              },
              {
                "is": "SCREEN",
                "value": "menu-arena_screen-top"
              }
            ]
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Orb Available, Starting Fight"
            },
            {
              "type": "TAP",
              "value": "menu-arena-setup"
            },
            { "type": "CALL", "value": "@keepAlive" },
            {
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-menu-orbs": {
      "statements" : [
        {
          "condition" : {
            "not"   : "SCREEN",
            "value" : "menu-arena-have-orbs",
            "andOr" : [
              {
                "is"    : "SCREEN",
                "value" : "menu-arena_screen"
              },
              {
                "is"    : "SCREEN",
                "value" : "menu-arena_screen-friends"
              },
              {
                "is"    : "SCREEN",
                "value" : "menu-arena_screen-top"
              }
            ]
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Out of Orbs, going home"
            },
            { "type": "CALL", "value": "@keepAlive" },
            {
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            {
              "type": "MOVE",
              "value": "any_to_home",
              "args": {"toState": "${_route_from_arena}"}
            }
          ]
        }
      ]
    },

    "_arena-menu-rules": {
      "statements" : [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-rules"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-arena-ok"
            },
            {
              "type"  : "WAIT",
              "value" : "3000"
            },
            {
              "type"  : "REPEAT",
              "value" : ""
            }
          ]
        }
      ]
    },

    "_arena-find_depart_team": {
      "name": "Arena - Find Depart Team",
      "statements": [
        {
          "condition": {
            "is"    : "SCREEN",
            "value" : "menu-arena-opponent_select",
            "and" : [{
              "not": "SCREEN",
              "value": "arena-depart-team_${arena-party-index}",
              "and": [
                {
                  "not": "SCREEN",
                  "value": "arena-menu-party-select"
                }
              ]
            }]
          },
          "actions": [
            {
              "type": "TAP",
              "value": "arena-party-select"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition" : {
            "is"    : "SCREEN",
            "value" : "arena-menu-party-select",
            "and"   : [
              {
                "is"    : "SCREEN",
                "value" : "arena-depart-team_${arena-party-index}"
              }
            ]
          },
          "actions"   : [
            {
              "type"  : "TAP",
              "value" : "arena-party-select"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type"  : "REPEAT",
              "value" : ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "arena-menu-party-select",
            "and": [
              {
                "not": "SCREEN",
                "value": "arena-depart-team_${arena-party-index}"
              }
            ]
          },
          "actions": [
            {
              "type": "SWIPE_RIGHT",
              "value": "menu-depart-units"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-menu-opponent-select": {
      "statements" : [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-opponent_select"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-arena-opponent_first"
            },
            {
              "type": "WAIT",
              "value": "2000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-battle-start": {
      "statements" : [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-confirm_select"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-arena-opponent_confirm-yes"
            },
            {
              "type": "WAIT",
              "value": "5000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-menu-confirm-select": {
      "statements" : [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-begin"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "menu-arena-begin"
            },
            {
              "type": "WAIT",
              "value": "5000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-menu-begin": {
      "statements" : [
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Battle Started"
            },
            {
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            { "type": "CALL", "value": "@keepAlive" },
            {
              "type": "ADD",
              "var": "arena_runs",
              "value": "1"
            },
            {
              "type": "MOVE",
              "value": "arena-battle-setup"
            }
          ]
        }
      ]
    },

    "arena-battle-setup": {
      "name": "Arena - Battle - Setup",
      "includes": [
        "_arena-battle-fight",
        "_common-no_op"
      ],
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-repeat"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Moving to Fight"
            },
            {
              "type": "MOVE",
              "value": "arena-battle-fight"
            }
          ]
        }
      ]
    },

    "arena-battle-fight": {
      "name": "Arena - Battle - Fight",
      "includes": [
        "_arena-battle-fight",
        "_common-no_op"
      ],
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-repeat"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Fighting (You should override this, auto isn't good)"
            },
            {
              "type": "TAP",
              "value": "battle-auto"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        }
      ]
    },

    "_arena-battle-fight": {
      "name": "Arena - Battle - Common Fight",
      "variables": {
        "enemy_health_seen": {
          "type": "INT",
          "value": "0"
        }
      },
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "battle-actions"
          },
          "actions": [
            {
              "type": "TAP",
              "value": "battle-actions-back"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-rewards"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Reward found - OK"
            },
            {
              "type": "TAP",
              "value": "menu-arena-rewards-ok"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "battle-enemy_bar",
            "and": [
              {
                "var": "enemy_health_seen",
                "is": "EQUAL",
                "value": "0"
              }
            ]
          },
          "actions": [
            {
              "type": "SET",
              "var": "enemy_health_seen",
              "value": "1"
            },
            {
              "type": "INFO",
              "value": "Enemy health bar has been seen"
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "game-battle-over"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "It's Over, Tapping"
            },
            {
              "type": "TAP",
              "value": "menu-arena-results-ok"
            },
            {
              "type": "WAIT",
              "value": "500"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-results"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Tapping OK"
            },
            {
              "type": "TAP",
              "value": "menu-arena-results-ok"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena-rank_up"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Tapping OK"
            },
            {
              "type": "TAP",
              "value": "menu-arena-rank_up-ok"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena_screen",
            "or": [
              {
                "is": "SCREEN",
                "value": "menu-arena_screen-friends"
              },
              {
                "is": "SCREEN",
                "value": "menu-arena_screen-top"
              }
            ]
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Restarting"
            },
            {
              "type": "MOVE",
              "value": "arena-home"
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "battle-menu-arena"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Battle menu was left open, closing"
            },
            {
              "type": "TAP",
              "value": "battle-menu-back"
            },
            {
              "type": "WAIT",
              "value": "500"
            }
          ]
        },
        {
          "condition": {
            "not": "SCREEN",
            "value": "battle-enemy_bar",
            "and": [
              {
                "var": "enemy_health_seen",
                "is": "EQUAL",
                "value": "1"
              },
              {
                "var": "_loops",
                "is": "GREATER",
                "value": "15"
              }
            ]
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Enemy health bar is missing, tapping to finish"
            },
            {
              "type": "SET",
              "var": "enemy_health_seen",
              "value": "2"
            },
            {
              "type": "TAP",
              "value": "menu-arena-results-ok"
            },
            {
              "type": "WAIT",
              "value": "500"
            }
          ]
        }
      ]
    },

    "_any_router_to_arena": {
      "name": "Any - Home Can Goto Arena Screen?",
      "variables": {
        "toState": {
          "value": "ARENA",
          "type": "STRING"
        }
      },
      "statements": [
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-home",
            "and": [
              {
                "is": "EQUAL",
                "value": "ARENA",
                "var": "toState"
              }
            ]
          },
          "actions": [
            {
              "type": "SET",
              "var": "setup",
              "value": "0"
            },
            {
              "type": "SET",
              "value": "0",
              "var": "_screen_saver"
            },
            {
              "type": "MOVE",
              "value": "home_to_arena",
              "condition": {
                "is": "EQUAL",
                "value": "1",
                "var": "allow-arena"
              }
            },
            {
              "type": "SET",
              "value": "${_route_from_arena}",
              "var": "toState"
            },
            {
              "type": "REPEAT"
            }
          ]
        }
      ]
    },

    "home_to_arena": {
      "name": "Home - To Arena",
      "includes": [
        "_home_daily_fixes",
        "_common-no_op"
      ],
      "variables": {
        "_first": {
          "type": "INT",
          "value": "0"
        }
      },
      "statements": [
        {
          "condition": {
            "is": "EQUAL",
            "var": "_first",
            "value": "0"
          },
          "actions": [
            { "type": "CALL", "value": "@keepAlive" },
            { "type": "SET", "var": "_first", "value": "1"}
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-home"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Going to Arena"
            },
            { "type": "CALL", "value": "@keepAlive" },
            {
              "type": "TAP",
              "value": "menu-home-arena"
            },
            {
              "type": "WAIT",
              "value": "10000"
            },
            {
              "type": "REPEAT",
              "value": ""
            }
          ]
        },
        {
          "condition": {
            "is": "SCREEN",
            "value": "menu-arena_screen"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Found Arena Screen"
            },
            {
              "type": "MOVE",
              "value": "arena-home"
            }
          ]
        },
        {
          "condition": {
            "is": "GREATER",
            "var": "_loops",
            "value": "60"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Could not find Arena screen, switching to ${_route_from_arena}"
            },
            {
              "type": "MOVE",
              "value": "any_to_home",
              "args": {
                "toState": "${_route_from_arena}"
              }
            }
          ]
        }
      ]
    },

    "_reset-include_arena": {
      "name": "Reset - Arena",
      "statements": [
        {
          "condition": {
            "is": "BOOLEAN",
            "value": "true"
          },
          "actions": [
            {
              "type": "INFO",
              "value": "Reset Arena Run Count"
            },
            {
              "type": "SET",
              "value": "0",
              "var": "arena_runs"
            }
          ]
        }
      ]
    }

  }
}